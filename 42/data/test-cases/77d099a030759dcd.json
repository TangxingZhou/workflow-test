{"uid":"77d099a030759dcd","name":"Restore Cluster Via COS","fullName":"src.tests.upgrade.test_mo_upgrade.UpgradeMOTestSuite#test_restore_cluster","historyId":"9a623f1c5f118cbfc5d4bcc42f222438","time":{"start":1710256840915,"stop":1710258660561,"duration":1819646},"description":"This test attempts to restore cluster via COS.","descriptionHtml":"<p>This test attempts to restore cluster via COS.</p>\n","status":"passed","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"k8s_controller_client","time":{"start":1710252677126,"stop":1710252677135,"duration":9},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"k8s_unit_client","time":{"start":1710252677135,"stop":1710252677143,"duration":8},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"_xunit_setup_module_fixture_src.tests.upgrade.test_mo_upgrade","time":{"start":1710252677144,"stop":1710252677144,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"envs","time":{"start":1710252677144,"stop":1710252677144,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"setup_module","time":{"start":1710252677144,"stop":1710252677144,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"configs","time":{"start":1710252677144,"stop":1710252677149,"duration":5},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"moc_templates","time":{"start":1710252677149,"stop":1710252677212,"duration":63},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"_xunit_setup_class_fixture_UpgradeMOTestSuite","time":{"start":1710252677212,"stop":1710252677212,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"setup_class","time":{"start":1710252677212,"stop":1710252678932,"duration":1720},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false}],"testStage":{"description":"This test attempts to restore cluster via COS.","status":"passed","steps":[{"name":"开始恢复集群","time":{"start":1710256840915,"stop":1710256841953,"duration":1038},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"恢复原集群的root账号密码","time":{"start":1710256841953,"stop":1710256842748,"duration":795},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"等待恢复集群状态变为'Active'","time":{"start":1710256842748,"stop":1710258660561,"duration":1817813},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false}],"attachments":[{"uid":"13d05b1335c3b2b1","name":"log","source":"13d05b1335c3b2b1.txt","type":"text/plain","size":557019}],"parameters":[],"shouldDisplayMessage":false,"stepsCount":3,"attachmentsCount":1,"hasContent":true},"afterStages":[{"name":"_xunit_setup_class_fixture_UpgradeMOTestSuite::0","time":{"start":1710258661576,"stop":1710258661836,"duration":260},"status":"broken","statusMessage":"kubernetes.client.exceptions.ApiException: (404)\nReason: Not Found\nHTTP response headers: HTTPHeaderDict({'Audit-Id': '8acd9be6-e3cb-4115-bfc6-8b1ebadddfd2', 'Cache-Control': 'no-cache, private', 'Content-Type': 'application/json', 'X-Kubernetes-Pf-Flowschema-Uid': '48b55f7b-9c02-4b20-90e7-cfd0e4132673', 'X-Kubernetes-Pf-Prioritylevel-Uid': '2f4a6271-f121-49c6-be12-aff8d8fbd609', 'Date': 'Tue, 12 Mar 2024 15:51:01 GMT', 'Content-Length': '222'})\nHTTP response body: {\"kind\":\"Status\",\"apiVersion\":\"v1\",\"metadata\":{},\"status\":\"Failure\",\"message\":\"pods \\\"restore-restore-freetier-02\\\" not found\",\"reason\":\"NotFound\",\"details\":{\"name\":\"restore-restore-freetier-02\",\"kind\":\"pods\"},\"code\":404}\n\n\n","statusTrace":"  File \"/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/allure_commons/_allure.py\", line 221, in __call__\n    return self._fixture_function(*args, **kwargs)\n  File \"/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/fixtures.py\", line 917, in _teardown_yield_fixture\n    next(it)\n  File \"/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/python.py\", line 868, in xunit_setup_class_fixture\n    _call_with_optional_argument(func, self.obj)\n  File \"/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/_pytest/python.py\", line 786, in _call_with_optional_argument\n    func(arg)\n  File \"/home/runner/work/workflow-test/workflow-test/src/tests/upgrade/test_mo_upgrade.py\", line 421, in teardown_class\n    UpgradeMOTestSuite.k8s_unit_client.v1_api.delete_namespaced_pod(\n  File \"/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/kubernetes/client/api/core_v1_api.py\", line 12550, in delete_namespaced_pod\n    return self.delete_namespaced_pod_with_http_info(name, namespace, **kwargs)  # noqa: E501\n  File \"/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/kubernetes/client/api/core_v1_api.py\", line 12657, in delete_namespaced_pod_with_http_info\n    return self.api_client.call_api(\n  File \"/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/kubernetes/client/api_client.py\", line 348, in call_api\n    return self.__call_api(resource_path, method,\n  File \"/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/kubernetes/client/api_client.py\", line 180, in __call_api\n    response_data = self.request(\n  File \"/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/kubernetes/client/api_client.py\", line 415, in request\n    return self.rest_client.DELETE(url,\n  File \"/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/kubernetes/client/rest.py\", line 270, in DELETE\n    return self.request(\"DELETE\", url,\n  File \"/opt/hostedtoolcache/Python/3.8.18/x64/lib/python3.8/site-packages/kubernetes/client/rest.py\", line 238, in request\n    raise ApiException(http_resp=r)\n","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":0,"hasContent":true},{"name":"_xunit_setup_module_fixture_src.tests.upgrade.test_mo_upgrade::0","time":{"start":1710258661838,"stop":1710258661838,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false}],"labels":[{"name":"tag","value":"Restore"},{"name":"tag","value":"MO"},{"name":"epic","value":"MOC Test Automation"},{"name":"severity","value":"critical"},{"name":"story","value":"Backup/Restore and Upgrade MO Cluster"},{"name":"owner","value":"TangxingZhou"},{"name":"feature","value":"Backup/Restore and Upgrade MO Cluster"},{"name":"suite","value":"Restore MO Cluster and Upgrade"},{"name":"tag","value":"dependency(depends=['UpgradeMOTestSuite::test_restore_mo_data'])"},{"name":"tag","value":"p0"},{"name":"parentSuite","value":"src.tests.upgrade"},{"name":"subSuite","value":"UpgradeMOTestSuite"},{"name":"host","value":"fv-az665-461"},{"name":"thread","value":"2353-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"src.tests.upgrade.test_mo_upgrade"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[{"name":"issue-2542","url":"https://github.com/matrixorigin/MO-Cloud/issues/2542","type":"issue"}],"hidden":false,"retry":false,"extra":{"severity":"critical","owner":"TangxingZhou","retries":[],"categories":[],"tags":["p0","MO","dependency(depends=['UpgradeMOTestSuite::test_restore_mo_data'])","Restore"]},"source":"77d099a030759dcd.json","parameterValues":[]}